<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Everybox í…ŒìŠ¤íŠ¸ìš© ë¡œê·¸ì¸/íšŒì›ê°€ì…</title>
</head>
<body>
  <h2>ğŸ“ Everybox ëŒ€í•™ìƒ ì „ìš© ë¡œê·¸ì¸ / íšŒì›ê°€ì…</h2>

  <h3>ğŸ“Œ íšŒì›ê°€ì…</h3>
  <form id="signupForm">
    <label>ì´ë©”ì¼ (@ac.kr): <input type="email" id="signupEmail" required></label><br>
    <label>ë¹„ë°€ë²ˆí˜¸: <input type="password" id="signupPassword" required></label><br>
    <label>ë‹‰ë„¤ì„: <input type="text" id="signupNickname" required></label><br>
    <button type="submit">íšŒì›ê°€ì…</button>
  </form>
  <div id="signupResult" style="margin-top: 10px; color: green;"></div>

  <hr>

  <h3>ğŸ” ë¡œê·¸ì¸</h3>
  <form id="loginForm">
    <label>ì´ë©”ì¼: <input type="email" id="loginEmail" required></label><br>
    <label>ë¹„ë°€ë²ˆí˜¸: <input type="password" id="loginPassword" required></label><br>
    <button type="submit">ë¡œê·¸ì¸</button>
  </form>
  <div id="loginResult" style="margin-top: 10px; color: blue;"></div>

  <script>
    const BASE_URL = "http://localhost:8080"; // ì„œë²„ ì£¼ì†Œ

    // íšŒì›ê°€ì…
    document.getElementById("signupForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const email = document.getElementById("signupEmail").value;
      const password = document.getElementById("signupPassword").value;
      const nickname = document.getElementById("signupNickname").value;

      const response = await fetch(`${BASE_URL}/auth/signup`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password, nickname })
      });

      const text = await response.text();
      document.getElementById("signupResult").innerText = response.ok ? `âœ… ${text}` : `âŒ ${text}`;
    });

    // ë¡œê·¸ì¸
    document.getElementById("loginForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const email = document.getElementById("loginEmail").value;
      const password = document.getElementById("loginPassword").value;

      const response = await fetch(`${BASE_URL}/auth/login`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password })
      });

      const text = await response.text();
      if (response.ok) {
        localStorage.setItem("jwt", text.replace("Bearer ", ""));
        document.getElementById("loginResult").innerText = "âœ… ë¡œê·¸ì¸ ì„±ê³µ! í† í° ì €ì¥ë¨.";
      } else {
        document.getElementById("loginResult").innerText = `âŒ ${text}`;
      }
    });
  </script>
</body>
</html>
